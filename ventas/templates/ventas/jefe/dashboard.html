{% extends "base.html" %}
{% block title %}Panel de Jefe{% endblock %}

{% block content %}
<style>
  .dashboard-card {
    transition: transform .2s;
    cursor: pointer;
  }
  .dashboard-card:hover {
    transform: scale(1.05);
  }
  .dashboard-link { text-decoration: none; }
</style>

<div class="container py-4">
  <h1 class="mb-4 text-warning">Dashboard de Jefe</h1>

  <div class="row g-4 mb-5">
    <!-- Productos -->
    <div class="col-md-3">
      <a href="{% url 'productos_list' %}" class="dashboard-link">
        <div class="card dashboard-card text-center shadow">
          <div class="card-body">
            <h5 class="card-title">Productos</h5>
            <p class="h2">{{ total_prod }}</p>
            <small>Activos: {{ activos }} | Inactivos: {{ inactivos }}</small>
          </div>
        </div>
      </a>
    </div>
    <!-- Ventas -->
    <div class="col-md-3">
      <a href="{% url 'ventas_list' %}" class="dashboard-link">
        <div class="card dashboard-card text-center shadow">
          <div class="card-body">
            <h5 class="card-title">Ventas</h5>
            <p class="h2">{{ total_ventas }}</p>
            <small>Ingresos: ${{ ingresos }}</small>
          </div>
        </div>
      </a>
    </div>
    <!-- Usuarios -->
    <div class="col-md-3">
      <a href="{% url 'usuario_list' %}" class="dashboard-link">
        <div class="card dashboard-card text-center shadow">
          <div class="card-body">
            <h5 class="card-title">Usuarios</h5>
            <p class="h2">{{ total_usuarios }}</p>
            <small>Registrados</small>
          </div>
        </div>
      </a>
    </div>
    <!-- Acciones Rápidas -->
    <div class="col-md-3">
      <div class="card text-center shadow">
        <div class="card-body">
          <h5 class="card-title">Acciones</h5>
          <a href="{% url 'producto_create' %}" class="btn btn-primary mb-2 w-100">Nuevo Producto</a>
          <a href="{% url 'register' %}" class="btn btn-secondary w-100">Nuevo Usuario</a>
        </div>
      </div>
    </div>
  </div>

  <h3 class="mb-3">Últimas 5 Ventas</h3>
  {% if ultimas_ventas %}
  <table class="table table-striped table-dark">
    <thead>
      <tr>
        <th>ID</th><th>Fecha</th><th>Usuario</th><th>Total</th>
      </tr>
    </thead>
    <tbody>
      {% for v in ultimas_ventas %}
      <tr>
        <td>{{ v.id }}</td>
        <td>{{ v.fecha|date:"d-m-Y H:i" }}</td>
        <td>{{ v.usuario.username }}</td>
        <td>${{ v.total }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
    <p>No hay ventas registradas aún.</p>
  {% endif %}
</div>
{% endblock %}
